///////////////////////////////////////////////////////////////////////////////
//
//  CHECK IF THE PAGE IS SCROLLED
//
///////////////////////////////////////////////////////////////////////////////

var crown = document.querySelector("body");
window.addEventListener("scroll", checkScroll, false);
var body = document.body,
  html = document.documentElement;
var height = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);

function checkScroll() {
  if (window.pageYOffset >= 1) {
    return crown.classList.add("is-scrolled"),  setTimeout(function(){ crown.classList.remove("isnot-scrolled") }, 2) ;
  }
  if (crown.classList.contains("is-scrolled")) {
    return crown.classList.remove("is-scrolled"),  setTimeout(function(){ crown.classList.add("isnot-scrolled") }, 2) ;
  }
};

$(document).ready(function() {
  if (window.pageYOffset >= 1) {
    return crown.classList.add("is-scrolled"),  setTimeout(function(){ crown.classList.remove("isnot-scrolled") }, 2) ;
  }
});

///////////////////////////////////////////////////////////////////////////////
//
//  basic methods
//
///////////////////////////////////////////////////////////////////////////////

(function() {
  // helpers
  var regExp = function(name) {
    return new RegExp('(^| )' + name + '( |$)');
  };
  var forEach = function(list, fn, scope) {
    for (var i = 0; i < list.length; i++) {
      fn.call(scope, list[i]);
    }
  };
  // class list object with basic methods
  function ClassList(element) {
    this.element = element;
  }
  ClassList.prototype = {
    add: function() {
      forEach(arguments, function(name) {
        if (!this.contains(name)) {
          this.element.className += ' ' + name;
        }
      }, this);
    },
    remove: function() {
      forEach(arguments, function(name) {
        this.element.className = this.element.className.replace(regExp(name), '');
      }, this);
    },
    toggle: function(name) {
      return this.contains(name) ? (this.remove(name), false) : (this.add(name), true);
    },
    contains: function(name) {
      return regExp(name).test(this.element.className);
    },
    // bonus..
    replace: function(oldName, newName) {
      this.remove(oldName), this.add(newName);
    }
  };
  // IE8/9, Safari
  if (!('classList' in Element.prototype)) {
    Object.defineProperty(Element.prototype, 'classList', {
      get: function() {
        return new ClassList(this);
      }
    });
  }
  // replace() support for others
  if (window.DOMTokenList && DOMTokenList.prototype.replace == null) {
    DOMTokenList.prototype.replace = ClassList.prototype.replace;
  }
})();

// close open menu e dropdown menu when window is resized

$(window).resize(function() {
  var screen = $(window)
  if (screen.width() > 1279) {
    $( "body" ).removeClass( "navbar-is-open" );
    $(".navbar-collapse").removeClass( "show" );
    $(".navbar-toggler").addClass( "collapsed" ).attr('aria-expanded', 'false');
    $(".dropdown").removeClass( "show" );
    $(".dropdown-menu").removeClass( "show" );
    $(".dropdown-toggle").attr('aria-expanded', 'false');
  }
});

///////////////////////////////////////////////////////////////////////////////
//
//  anchors LINKS OFFSET
//
///////////////////////////////////////////////////////////////////////////////


$(document).ready(function() {
  $('.anchor-link').click(function() {
    var target = $(this.hash);
    if (target.length == 0) target = $('a[name="' + this.hash.substr(1) + '"]');
    if (target.length == 0) target = $('html');
    if ( $(window).width() < 959 ) {
      $('html, body').animate({ scrollTop: target.offset().top-72 }, 1000);
    } else {
      $('html, body').animate({ scrollTop: target.offset().top }, 1000);
    }
    return false;
  });
});


//

$(".navbar-toggler").click(function() {
  // toggle the class after half second
  setTimeout(function() {
    $("body").toggleClass("navbar-is-open");
  }, 100);
});

$('.navbar-nav a.close-menu, .btn-subscribe').on('click', function(){
  if ( $(window).width() < 959 ) {
    $('.navbar-collapse').collapse('hide');
    $("body").toggleClass("navbar-is-open");
  }
});

// Program navigation

$(function(){
  $('.nav-program-23').click(function(e){
    e.preventDefault();
    $('#pills-tab a[href="#pills-programm-23"]').tab('show');
    $(".dropdown").toggleClass("show");
    $(".dropdown-toggle").attr('aria-expanded', 'false');
    $(".dropdown-menu").toggleClass("show");
  })
  $('.nav-program-22').click(function(e){
    e.preventDefault();
    $('#pills-tab a[href="#pills-programm-22"]').tab('show');
    $(".dropdown").toggleClass("show");
    $(".dropdown-toggle").attr('aria-expanded', 'false');
    $(".dropdown-menu").toggleClass("show");
  })
})


///////////////////////////////////////////////////////////////////////////////
//
//  Program carousel
//
///////////////////////////////////////////////////////////////////////////////


$(document).ready(function() {
  if ( $(window).width() < 959 ) {
    addCarousel();
    $('.carousel').carousel({
        pause: false,
        interval: false
    });
  } else {
    removeCarousel();
  }
});

$(window).resize(function() {
  if ( $(window).width() < 959 ) {
    addCarousel();
    $('.carousel').carousel({
        pause: false,
        interval: false
    });
  } else {
    removeCarousel();
  }
});

function addCarousel() {
  $("#day-one").addClass( "carousel slide" ).attr('data-ride', 'carousel');
  $("#day-two").addClass( "carousel slide" ).attr('data-ride', 'carousel');
  $(".program__inner").addClass( "carousel-inner" );
  $(".program__inner").removeClass( "table table-hover" );
  $(".program__item").addClass( "carousel-item" );
}

function removeCarousel() {
  $("#day-one").removeClass( "carousel slide" ).attr('data-ride', 'carousel');
  $("#day-two").removeClass( "carousel slide" ).attr('data-ride', 'carousel');
  $(".program__inner").removeClass( "carousel-inner" );
  $(".program__inner").addClass( "table table-hover" );
  $(".program__item").removeClass( "carousel-item" );
}

// scrolltotop

$(document).ready(function(){

    if ($(this).scrollTop() > 100) {
      $('.btn-scrolltotop').fadeIn();
    } else {
      $('.btn-scrolltotop').fadeOut();
    }
  
  //Check to see if the window is top if not then display button
  $(window).scroll(function(){
    if ($(this).scrollTop() > 100) {
      $('.btn-scrolltotop').fadeIn();
    } else {
      $('.btn-scrolltotop').fadeOut();
    }
  });
  
  //Click event to scroll to top
  $('#scrolltotop').click(function(){
    event.preventDefault();
    $('html, body').animate({scrollTop : 0},800);
    return false;
  });
  
});



$(document).ready(function(){

  // ScrollReveal
  window.sr = ScrollReveal({ delay: 1000, duration: 1000, mobile: false, scale: 1 });
  sr.reveal('.reveal');
  sr.reveal('.splash', { duration: 1000, delay: 0, scale: 0.5 }, 50);
  sr.reveal('.s-home .main-navbar', { origin: 'top', distance: '10rem', duration: 1000, delay: 6000-4000 });
  sr.reveal('.hero__illustration', { origin: 'right', distance: '40rem', duration: 2000, delay: 4500-4000 });
  sr.reveal('.hero__intro', { duration: 1000, delay: 6000-4000 });
  sr.reveal('.hero__ship-container', { origin: 'right', distance: '40rem', duration: 2000, delay: 5000-4000 });

  sr.reveal('.illustration--left', { origin: 'left', distance: '40rem', duration: 1000, delay: 0 });
  sr.reveal('.illustration--left .illustration__characters', { origin: 'left', distance: '40rem', duration: 1000, delay: 500 });
  sr.reveal('.illustration--right', { origin: 'right', distance: '40rem', duration: 1000, delay: 0 });
  sr.reveal('.illustration--right .illustration__characters', { origin: 'right', distance: '40rem', duration: 1000, delay: 500 });
  sr.reveal('.illustration--party', { origin: 'right', distance: '40rem', duration: 1000, delay: 0 });
  sr.reveal('.illustration--party .illustration__characters', { origin: 'right', distance: '40rem', duration: 1000, delay: 500 });
  
});
// splash

// $('#splash-screen').modal('show');

// setTimeout(function() {
//   $('#splash-screen').modal('hide');
// }, 2000);


// countdown

var opening = moment.tz('2018-03-28 10:43','YYYY-MM-DD h:mm', "Europe/Amsterdam");

window.setInterval(function(){
  var current = new Date();
  var expiry  = new Date(opening)
  if(current.getTime()>expiry.getTime()){
    $('#countdown-view').hide();
    $('#eventbrite-view').show();
  } else {
    $('#countdown-view').show();
    $('#eventbrite-view').hide();
  }
});


$('#countdown').countdown(opening.toDate(), function(event) {
  $(this).html(event.strftime(''
    + '<span class="countdown__time countdown__days text-dark">%D <span class="countdown__tag font-weight-bold text-primary text-uppercase">Giorni</span></span>'
    + '<span class="countdown__time countdown__hours text-dark">%H <span class="countdown__tag font-weight-bold text-primary text-uppercase">Ore</span></span>'
    + '<span class="countdown__time countdown__min text-dark">%M <span class="countdown__tag font-weight-bold text-primary text-uppercase">Min</span></span>'
    + '<span class="countdown__time countdown__sec text-dark">%S <span class="countdown__tag font-weight-bold text-primary text-uppercase">Sec</span></span>'));
});

$(window).on('load', function () {
  $('.tickets__iframe').attr('src', 'https://www.eventbrite.com/tickets-external?eid=44214066463&ref=etckt');
  jQuery.ajax({
    url: "//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js",
    dataType: "script",
    cache: true
  }).done(function() {
    (function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='ADDRESS';ftypes[3]='address';fnames[4]='PHONE';ftypes[4]='phone';}(jQuery));var $mcj = jQuery.noConflict(true);
  });
 });


// show page on load

$(window).on('load', function () {
  $("body").addClass('all-loaded');
});

